# Certbot CA Renewal Deployment with Netbox DCIM

This repository provides an automated kit to update/deploy new certificates issued by Certbot (LetsEncrypt's automated certificate provisioning tool) to remote servers. It is meant to be invoked by Certbot itself (via `runner.sh`) using Certbot's `renew_hook` functionality. The scripts herein utilize Netbox (https://github.com/netbox-community/netbox), a DCIM/IPAM tool created by Digital Ocean to manage which servers receive which certificate. 

While this was designed primarily to push out wildcard certificates to hosts after they have been renewed, it can really work for any certificate generated by Certbot.

The functionality is easy to update to use with another DCIM tool with an http/s api, Netbox happens to be my preferred tool.

## Requirements

This script assumes and requires the following: 

- A configured Netbox instance running somewhere on the network
    - A valid Netbox API Key 
    - Virtual Machies/Devices defined in Netbox
    - Tags defined in Netbox for hosts, matching the pattern `certauthority_sitename.com`, where "sitename.com" is the name of the certificate from Certbot (find your certificate name using `certbot certificates`)
- A Certbot instance that is renewing certificates
- A python virtual environment (configured by `setup.sh` in this repository)
